from sklearn.ensemble import RandomForestClassifier
from sklearn.feature_selection import SelectFromModel
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from imblearn.pipeline import Pipeline 
from imblearn.under_sampling import RandomUnderSampler

positive_count_train = y_train.value_counts()[0]
strategy = strategy = {1:positive_count_train, 2:positive_count_train*7, 3:positive_count_train*100, 4:positive_count_train*80, 6:positive_count_train*400, "a":positive_count_train*4000, "b":positive_count_train*15, "c":positive_count_train*50, "d":positive_count_train*200, "e":positive_count_train*25000, "m":positive_count_train*350, "n":positive_count_train*30}
#トレーニング数
#

select = SelectFromModel(RandomForestClassifier(max_depth=30, n_estimators=30, random_state=42))
scaler = StandardScaler()
clf = LogisticRegression()
rus = RandomUnderSampler(random_state=0, sampling_strategy = strategy)

estimator = [
    ('rus', rus),
    ('select', select),
    ('scaler', scaler),
    ('clf', clf)
]
pipe_smote = Pipeline(estimator)
pipe_smote.fit(X_train, y_train)
#pipeによるモデルの作製
#rus=アンダーサンプリング





X_resampled, y_resampled = rus.fit_resample(X_train, y_train)
y_resampled.value_counts()

y_pred = piperus.predict(X_test)
from sklearn.metrics import classification_report
print(classification_report(y_test, y_pred)


